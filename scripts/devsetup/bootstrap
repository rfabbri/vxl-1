#!/bin/bash

# script/bootstrap: Resolve all dependencies that the application requires to
#                   run.

set -e

cd "$(dirname "$0")/.."


if [[ "`uname`" != Linux ]]; then
  # MYOS="OSX"
  # Install macports or homebrew packages
  echo "Non-linux OS: if on Mac, Macports or Homebrew packages might have to be installed by you"
else
  # MYOS="Linux"
  # Attempt to install Ubuntu packages or other distro packages

  if command -v apt-get >/dev/null 2>&1; then
    echo "Debian-based tools found"
    if [[ $(lsb_release -rs) == "22.04" ]]; then
      PKGS="qtcreator qtbase5-dev qt5-qmake libxmu-dev libxi-dev"
    else
      PKGS="qt-sdk libxmu-dev libxi-dev"
    fi
    for i in $PKGS; do
      # PKG_OK=$(dpkg-query -W --showformat='${Status}\n' $i |grep "install ok installed")
      echo Checking for $i
      if [ $(dpkg-query -W -f='${Status}' $i 2>/dev/null | grep -c "ok installed") -eq 0 ]; then
        echo "No $i package. Setting up."
        sudo apt-get --yes install $i
      fi
    done
  else
    echo "WARNING: Not a debian-based distro, not installing dependencies."
  fi
fi
