#!/bin/bash
# This is just to make from a source directory 'path/foosrc', when the binary tree is in
# another directory 'path/foo-bin'.

#set -x
#MYMAKEOPTS="-j9"

case $# in
#       0)  ls *.c *.h *.cpp *.cxx *.txx *.m *.sci *.sce *.sh 2>/tmp/my---null;;
       0)  MYMAKEOPTS="-j17 -k" ;;
       *)  MYMAKEOPTS="" ;;
esac

mypwd=$PWD'/'
makecmd="make $MYMAKEOPTS"

#set -x

echo
echo "MYMAKEOPTS=$MYMAKEOPTS"
echo

SECONDS=0

if test `echo $mypwd|grep /pet/`; then
  echo $0: In pet project area.
  # TODO cd root
  mvn test $*
elif test -e `getswitchpath`/Makefile; then
  echo $0: In vxl-like source area.
  $makecmd -C `getswitchpath` $*
else
  echo $0: Running make in current directory.
  $makecmd $*
fi

if [ $SECONDS -ge 10 ]; then
  mysay 'yes.'
fi
