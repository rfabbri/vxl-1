\section{Introduction}

The goal of this project is to develop a generative appearance model to be used in several computer vision applications
such as image representation, image generation, image matching, multiview image calibration \etc. Our appearance model is 
called topological appearance graph (TAG) whose design is inspired from the idea of sketching functions using
their critical points. The TAG is a graph whose nodes are the image critical points (minimum, maximum and
saddle points) and the edges between them are the topographic curves connecting them.

The idea of using a critical point graph is not novel. The most well known representations are Surface Networks \cite{Pfaltz:1976,Rana:GCC07}, Critical Point Configuration
Graphs \cite{Nackman:PAMI84} and Morse-Smale Complexes \cite{Bremer:etal:TVCG04}. These are actually nearly identical to TAG, but have not been used in computer vision applications extensively. Our plan is to augment the TAG by
integrating the edges and curves of an image into the representation. However, this document will not discuss the augmented version, since we have not implemented anything related, yet.

\begin{figure}
\centering
\subfloat[8 neighbor local detection]{\includegraphics[width=.45\textwidth]{img/8neig-crits.png}}\;\;
\subfloat[Our algorithm]{\includegraphics[width=.45\textwidth]{img/our-algo-crits.png}}
\caption{Comparison of critical points computed using different algorithms. Observe the differences between the saddle points (blue pluses).}
\label{fig:comparison_8neig}
\end{figure}

Correct critical point detection is essential for this project. But, it is a challenging task, especially the detection of saddle points. Local saddle detectors produce many false positives and false negatives. Therefore, we use a different definition of saddle points when designing our algorithms. We define saddle points as the intersection points of watershed and watercourse lines. See Figure \ref{fig:comparison_8neig} for a comparison of our method to the traditional 8 neighbor local detection.

There are mainly two contributions in this project. 
\begin{enumerate}
\item Saddle detection as intersection of watershed and watercourse lines. While traditional approaches use local processes, this proposed approach is global. (probably novel)
\begin{enumerate}
\item Detection of extended minima/maxima/saddle as an integral part of the algorithm. (not so sure if new)
\end{enumerate}
\item Use of critical points and surface networks in various computer vision tasks such as image matching, multiview calibration, image generation \etc.
\end{enumerate}

For more details on the goals of this project, please read what was proposed in the NSF'12 proposal:


\begin{figure}
  \centerline{
{\footnotesize\textit{(a)}}   \includegraphics[height=0.1435\textwidth]{img/HOG-isosurface.png}
{\footnotesize\textit{(b)}}  \includegraphics[height=0.1435\textwidth]{img/hog-dragon-fly.png}
{\footnotesize\textit{(c)}}  \includegraphics[height=0.1435\textwidth]{img/hog-trex.png}
{\footnotesize\textit{(d)}}  \includegraphics[height=0.1435\textwidth]{img/hog-trex-imposter.png}
{\footnotesize\textit{(e)}}  \includegraphics[height=0.1435\textwidth]{img/hog-histograms.png}}
      \caption{The equivalent classes of images sharing the
same HOG representation is huge, to the point that any image patch (b)
(HOG in red) can
be deformed  toward any other image patch (c) (HOG in blue), while maintaining the same HOG representation,
thus creating an imposter (d)\ (HOG in black), with minor differences from the target
image.   }
   \label{fig:hog}

\end{figure}


\noindent {\bf A Novel Approach to Modeling Appearance:} Popular HOG/SIFT-like models capture local appearance as a histogram of gradient orientations. The use of gradients and orientation direction factor out additive and multiplicative changes, respectively, while the use of a histogram builds resilience against small deformations. Together, they build some invariance against illumination, pose and other changes and these descriptors have been very effective in recognition systems. Unfortunately, the equivalence class of images mapping to a collection of such histograms, either at sparsely or densely sampled points, is huge and uncontrolled, Figure \ref{fig:hog}. Such defects cannot be fully observed at the current scale of datasets, but are expected to become prominent as the variability and number of exemplars and categories both increase significantly.

We seek a generative representation where the induced equivalence class of images is better modeled. Elementary Calculus prescribes sketching a function of one variable using its critical points, thus inducing an intuitive equivalence class for a set of specified critical points. What is the two-dimensional analogue for sketching an image when considered as a two-dimensional scalar field? Is the resulting qualitative structure immune to changes induced by visual transformations? Cayley, Maxwell, and mathematically minded geographers after them have studied the qualitative topographical structure of a landscape based on a surface network of topographical curves connecting critical points of image gradient, namely, peaks, pits and passes \cite{Cayley:1859,Maxwell:1870,Pfaltz:1976,Nackman:PAMI84,Rosin:JVCIR95,Wood:2000,Rana:GCC07}. In this proposal we refer to the graph whose nodes are critical points and whose links are topographical curves as the \textbf{Topological Appearance Graph (TAG)}. 

We will not cover the history of this area, which is complex, involving confusion between local and global definitions \cite{Saint-Venant:1852,Champ:CRASP:1854,Jordan:1872,Koenderink:Structure:84,Rieger:IJCV97} and an evolving notion of genericity \cite{Kergosien:Thom:1980,Damon:Arch-Rat-Mech-Anal:1995,Damon:JAM98}. We adopt Jordan's definition \cite{Jordan:1872} with a weak genericity condition \cite{Damon:Arch-Rat-Mech-Anal:1995}, as in \cite{Rieger:Biol-Cybernet:1992,Rieger:J-Math-Img-Vision:1995,Rieger:IJCV97}; see \cite{Kalaycilar:Kimia:AppearanceTechReportURL}. Beyond geography, the topographical graphs have also been used in computer vision, but with a rather sparse history \cite{Nackman:PAMI84,Rosin:etal:PR92,Rosin:JVCIR95,Takahashi:etal:CGF95,Chinveeraphan:etal:ICPR96,Shidfar:etal:BMVC10,Shidfar:Colchester:MVIP11}. Note that~\cite{Gu:etal:ECCV10} uses a graph where stable critical points of the Laplacian image are connected by region grouping. The excellent image matching results encourage our approach which in contrast is based on critical points of the image and is connected by topographic curves. 

% We note that \cite{Gu:etal:ECCV10} uses region grouping to establish connectivity among min/max points of the Laplacian of the image and use the resulting critical nets for image matching. Their excellent results are encouraging to our approach which is based on critical points of the image itself and where the connectivity established by topographical curves.

The insight underlying the proposed use of a TAG for capturing appearance is that the location and value of critical points are both invariant to additive and multiplicative image changes and the topological neighborhood structure is invariant to a range of deformations. Thus, critical points can potentially serve as a replacement for both \textit{(i)} interest points and \textit{(ii)} regional descriptors. We probed the repeatability of critical points using dense correspondence in a multiview, multi-illumination dataset \cite{Usumezbas:MultiviewIllumDB:URL,Usumezbas:Kimia:3DIMPVT12}: the top 10\% most significant (ranked by curvature) critical points while roughly equal in number, outperform both Harris and SIFT in repeatability, both in narrow and wide base-line conditions, and under illumination changes. Thus, they can potentially be used together with the local graph structure as a descriptor in a traditional recognition approach. We will implement this approach as a baseline so as to enable progress in the remaining components of the proposal, while a more intriguing approach to capturing appearance is developed below. 

\noindent {\bf Robust Computation Using a Local Form Catalogue:} We aim to resolve ambiguity in the local, discrete domain computation of critical points, mainly occurring at saddle points \cite{Fu:etal:MIA04}, by ensuring local form is one of the legal configurations \cite{Nackman:PAMI84}. Second, numerical instabilities generically arise when nearly parallel curves falling below resolution merge, thus producing illegal graph connectivity \cite{Nackman:PAMI84,Rosin:etal:PR92,Rosin:JVCIR95,Shidfar:etal:BMVC10,Shidfar:Colchester:MVIP11}. We posit that the main reason is that the image grid is used to compute topographic curves. We aim to develop a pixel-independent computational domain where multiple curves can simultaneously occupy a pixel and instead focus on satisfying the local form. The main impetus in achieving numerical robustness is that the computed graph should be the exact representation of an approximation of the image, as opposed to an approximation of the exact representation.

\noindent {\bf Patch Similarity via Edit Distance:} Descriptors are primarily used for measuring similarities between two patches as a basis of recognition. In the case of HOG, the similarity is extrinsic, \ie, the Euclidean distance in the representation space. It is much more appropriate, however, to measure similarities intrinsically by measuring the extent of deformation needed to morph one patch to another. Unfortunately, the search for geodesics in the appearance space is combinatorially impossible. Observe, however, that deformation paths can be represented by a discrete combination of critical point transitions (where one appearance equivalence class changes into another), thus reducing the underlying dimensionality, Figure~\ref{fig:cp_annihilation}. This is analogous to the approach of measuring the similarity between two shapes using the transitions of the medial axis where the evolution of the hair-like instabilities are themselves the representation of a shape deformation path. We plan to develop an edit distance metric between two TAGs based on the transition of the TAG.

\begin{figure}
\centering
\includegraphics[width=0.11\textwidth]{img/topographical-figs/y1_1.pdf}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/y1_2.pdf}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/y1_3.pdf}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/y1_4.pdf}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/y2_4.pdf}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/y2_3.pdf}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/y2_2.pdf}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/y2_1.pdf}\\
%\includegraphics[width=0.495\textwidth]{img/topographical-figs/arrow1.png}
%\includegraphics[width=0.495\textwidth]{img/topographical-figs/arrow2.png}
\includegraphics[width=.9\textwidth]{img/topographical-figs/arrowComb.png}\\
\includegraphics[width=0.11\textwidth]{img/topographical-figs/z1_1.png}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/z1_2.png}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/z1_3.png}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/z1_4.png}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/z2_4.png}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/z2_3.png}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/z2_2.png}
\includegraphics[width=0.11\textwidth]{img/topographical-figs/z2_1.png}\\
{\footnotesize\textit{(a)}} \hspace{1.0cm} {\footnotesize\textit{(b)}}  \hspace{1.0cm} {\footnotesize\textit{(c)}}  \hspace{1.0cm} {\footnotesize\textit{(d)}} \hspace{1.0cm} {\footnotesize\textit{(e)}}  \hspace{1.0cm} {\footnotesize\textit{(f)}}  \hspace{1.0cm} {\footnotesize\textit{(g)}}  \hspace{1.0cm} {\footnotesize\textit{(h)}}
\caption{
(First row) Observe in (a) and (h) two structurally similar 1D functions which have different critical points due to small perturbations. A sketch of the geodesic path represented as a pair of deformation paths, one from each shape, simplifies each function in discrete steps, as max and min annihilate, until the two functions are topologically equivalent. The second row shows a 2D analogue.\vspace{-0.2cm}}
\label{fig:cp_annihilation}
\end{figure}

\noindent {\bf TAG Simplification via Structural Smoothing and Self Similarity:} The TAG model partitions an image into slope districts. These are monotonic patches and can be qualitatively reconstructed by interpolating intensities at graph nodes and links, Figure~\ref{fig:TAG}(a-c). Additional accuracy will result if continuity across slope district boundaries are enforced (not shown here). A key question is whether the representation description length can be further reduced without adversely affecting its generative power, thus producing more effective equivalent classes. We plan to investigate three directions to address this point. First, we plan to iteratively effect a transition starting from the least-cost pair of critical points which are annihilated \cite{Bremer:etal:TVCG04,Weinkauf:Guenther:CGF09} and the process iterated up to some total cost.
This type of smoothing is structural/surgical and local, in contrast to diffusion-based models which remove fine detail at the cost of degrading coarse structure. Second, we will cross-correlate a local patch of the appearance graph with the rest of the graph using the above proposed edit distance measure to find self-similar structure~\cite{Shechtman:Irani:CVPR07}. A clustering of self-similar patches can lead to the notion of a {\em TAG-texton}.  Since TAG is topological, affine transformations and undulations of the surface, like those on the leopard in Figure~\ref{fig:TAG} should leave the graph intact. Note that local parts of the graphs need not have identical topology as long as the edit cost between them is low. Finally, for fragments whose TAG description length remains high after the above steps, we resort to a statistical model capturing the distribution of node degree, node intensities, link distances, and perhaps second-order attributes so that textures can be effectively synthesized using the TAG grammar. These three steps should handle shaded areas (faces), regular and irregular structural textures (carpet, bricks, and pebbles), near stochastic (wood grain) and stochastic textures (sand) \cite{Liu:etal:TOG04}. 
\begin{figure}
\centering
\subfloat[]{\includegraphics[height=0.075\textheight]{img/topographical-figs/leopard-texture.pdf}  }       
\subfloat[]{\includegraphics[height=0.075\textheight]{img/topographical-figs/leopard-tag.pdf}}
\subfloat[]{\includegraphics[height=0.075\textheight]{img/topographical-figs/leopard-recons.pdf}}
\subfloat[]{\includegraphics[height=0.075\textheight]{img/topographical-figs/leopard_tag_contours_rectangle.pdf}}
\subfloat[]{\includegraphics[height=0.075\textheight]{img/topographical-figs/leopard-sd-zoom-border.pdf}}
\subfloat[]{\includegraphics[height=0.075\textheight]{img/topographical-figs/leopard_sd_examples_zoomed_highlighted_contour.png}}
\subfloat[]{\includegraphics[height=0.075\textheight]{img/topographical-figs/leopard_arm_fragment_tag.pdf}}
\subfloat[]{\includegraphics[height=0.075\textheight]{img/topographical-figs/leopard_body_fragment_tag.pdf}}
\subfloat[]{\includegraphics[height=0.075\textheight,width=0.15\textwidth]{img/topographical-figs/leopard_body_fragment_affine_tag.pdf}}
\caption{A small texture patch (a) with the Topographical Appearance Graph (TAG) superimposed in (b) is reconstructed in (c) using diffusion from TAG-stored intensities. (d) The TAG of a full image where peaks and pits are triangle and circulars icons, respectively, watersheds/watercourses are shown in yellow/purple curves, respectively, and saddle points are their intersection points. Red curves are contour fragments. (f) The intersection region of hills and dales is a slope district which is a monotonic patch of the image which can be effectively represented just from the intensity values at the nodes. (g) The ``leopard arm'' fragment with its TAG. (h) The ``leopard torso'' fragment with its TAG (i) The same torso fragment and its TAG after an affine transformation.}
\label{fig:TAG}
\end{figure}

