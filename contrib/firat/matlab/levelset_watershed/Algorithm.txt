Critical Point Detection and Toplogical Appearance Graph (aka Surface Network) Extraction Algorithm

Input: I, sigma for smoothing
Output: min, max, saddle, min_links (ids of saddles connected to each min), max_links (ids of saddles connected to each max), saddle_links (ids of min/max points connected to each saddle)

Main algorithm steps:
1) Call min_saddle_detector(I, sigma)  to find saddles1 = (set of saddle points), min points and saddle_links1 = (ids of the 2 min points connected to each saddle in saddles1)
2) Call min_saddle_detector(-I, sigma) to find saddles2 = (set of saddle points), max points and saddle_links2 = (ids of the 2 max points connected to each saddle in saddles2)
3) Find the common saddles in saddles1 and saddles2 and store them as "saddles" and discard the rest.
4) Using saddle_links1 and saddle_links2 and the common saddle ids, construct a common "saddle_links" which has 2 max ids and 2 min ids for each saddle. Basically, this saddle_links structure is sufficient to represent the TAG of an image.
5) [Still being developed] Detect problematic saddles and either remove them or fix their wrong connections -> updated saddles and saddle_links
6) Using saddle_links, construct min_links and max_links (straightforward)
7) return the list of min, max, saddle, min_links, max_links, saddle_links

min_saddle_detector(I, sigma) algorithm steps:
1) Pad the image boundary using the mirror reflection of the image.
2) Smooth the padded image with a Gaussian with standard deviation of sigma [We may not use this step in the future, we may rely on structural smoothing after graph construction]
3) Sort all the intensity values in the image in ascending order.
4) start a loop with i = 1, Mask_prev = all 0's (each pixel is labeled if it is a basin pixel or not), Label_prev = all 0's (each pixel has a basin id, 0 -> not assigned)
	4.1) Set WaterLevel = sorted_I(i)
	4.2) Compute the mask where the image intensity <= WaterLevel. Store the result in Mask_curr. Note that in this mask the values are 0/-1 instead of 0/1
	4.3) Label_curr = Mask_curr
	4.4) Transfer labels from the previous iteration (Label_prev) into Label_curr. So, now Label_curr has the same labels as Label_prev, but additionally it also has pixels labeled as -1 which correspond to new pixels covered with water. These new pixels are called the "event pixels" which might correspond to min creation, saddle creation or nothing.
	4.5) Classify each connected component labeled as -1 in Label_curr as "min", "saddle candidate" or "nothing".
		4.5.1) It is a "saddle candidate" if it touches 2 separate regions with non-zero labels. [basin collision] -> this step probably requires more checks to avoid impostor saddles!
		4.5.2) It is a "min" if it is surrounded by zeros in Label_curr [basin creation]
		4.5.3) It is "nothing" if it touches only one region with a non-zero label [basin growth]
	4.6) Add each classified component (either fit a surface to find the subpixel position or take the centroid of the component) to the appropriate list: min_list or saddle_list. Also if it is a saddle, store the ids of the basins in saddle_links. 
	4.7) Mask_prev = Mask_curr
	4.8) Label_prev = Label_curr
	4.9) Update -1's in Label_prev with appropriate labels (use label 0 for basin collision, use label N+1 for basin creation, use the label of the growing basin for basin growth)
	4.9) Exit loop if all the waterlevels have been visited.
5) return the list of mins, saddles and saddle_links


